<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kongì˜ ë¡œë˜ë²ˆí˜¸ ë§ì¶”ê¸°</title>
    <!-- Korean Lunar Calendar ë¼ì´ë¸ŒëŸ¬ë¦¬ CDN -->
    <script src="https://cdn.jsdelivr.net/npm/korean-lunar-calendar@0.0.14/dist/korean-lunar-calendar.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 25px;
            background-color: #f5f5f5;
        }   
        h3  {
            color: #333;   
        }   
        p { 
            font-size: 18px;
            color: #777;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .lotto-number {
            font-weight: bold;
            color: #e91e63;
        }
        .lunar-demo {
            margin: 20px 0;
            padding: 15px;
            background-color: #e8f4fd;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
        }
        .lunar-result {
            font-weight: bold;
            color: #1976D2;
            margin-top: 10px;
        }
    </style>
</head>
<body>  
    <h3>ë¡œë˜ ë²ˆí˜¸ ë§ì¶”ê¸° (ëŒ€ë°• ë‚˜ì„¸ìš”!!)</h3><br>
    
    <!-- ìŒë ¥ ë³€í™˜ ë°ëª¨ ì„¹ì…˜ -->
    <div class="lunar-demo">
        <h4>ğŸŒ™ ìŒë ¥ ë³€í™˜ ë°ëª¨</h4>
        <p>ì–‘ë ¥ ë‚ ì§œë¥¼ ì…ë ¥í•˜ë©´ ìŒë ¥ìœ¼ë¡œ ë³€í™˜í•´ë“œë¦½ë‹ˆë‹¤.</p>
        <input type="date" id="solarDate" value="2024-05-15">
        <button onclick="convertToLunar()">ìŒë ¥ìœ¼ë¡œ ë³€í™˜</button>
        <div id="lunarResult" class="lunar-result"></div>
    </div>

    <div>
        <ul id="lottoNumbersList">
            <!-- ì—¬ê¸°ì— ë¡œë˜ ë²ˆí˜¸ê°€ ì‚½ì…ë©ë‹ˆë‹¤ -->
        </ul>
    </div>

    <p>ì´ í”„ë¡œê·¸ë¨ì€ ê°œì¸ì˜ ê³µë¶€ë¥¼ ìœ„í•´ì„œ ë§Œë“¤ì—ˆìœ¼ë©°, ì˜ë¦¬ëª©ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
    <p>2024. 4. 7. ìˆ˜ì •</p>
    <p>2025. 4. 7. Perplexity, Claude, VScodeë¡œ ìˆ˜ì •</p>
    <p>2025. 6. 5.  ê·¸ë£¹1,2,3ì˜ ì ìš©ë³€ê²½ë° ìŒë ¥ë‚ ì§œ ì ìš©</p>
    <p>nanireu@gmail.com</p>

    <script>
        // ìŒë ¥ ë³€í™˜ í•¨ìˆ˜ ì¶”ê°€
        function convertToLunar() {
            try {
                // KoreanLunarCalendar ê°ì²´ ìƒì„±
                const calendar = new KoreanLunarCalendar();
                
                console.log("--- ì–‘ë ¥ -> ìŒë ¥ ë³€í™˜ ì˜ˆì‹œ (JS) ---");
                
                // ì…ë ¥ëœ ì–‘ë ¥ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸°
                const solarDateInput = document.getElementById('solarDate').value;
                if (!solarDateInput) {
                    alert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const [year, month, day] = solarDateInput.split('-').map(Number);
                
                // ë³€í™˜í•  ì–‘ë ¥ ë‚ ì§œ ì„¤ì •
                calendar.setSolarDate(year, month, day);
                
                // ë³€í™˜ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
                const lunarDate = calendar.getLunarCalendar();
                
                // ê²°ê³¼ ì¶œë ¥
                // ì›”ê³¼ ì¼ì€ ë‘ ìë¦¬ë¡œ í‘œì‹œë˜ë„ë¡ padStart ì‚¬ìš©
                const result = `ì–‘ë ¥ ${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')} >> ìŒë ¥ ${lunarDate.year}-${String(lunarDate.month).padStart(2, '0')}-${String(lunarDate.day).padStart(2, '0')} (ìœ¤ë‹¬: ${lunarDate.isLeapMonth})`;
                
                console.log(result);
                document.getElementById('lunarResult').textContent = result;
                
            } catch (error) {
                console.error('ìŒë ¥ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                document.getElementById('lunarResult').textContent = 'ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
            }
        }

        // lotto_data_with_lunar.json íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ ì¶œí˜„ ë¹ˆë„ë¥¼ ê³„ì‚°
        async function loadLottoData() {
            try {
                const response = await fetch('lotto_data_with_lunar.json'); // lotto_data_with_lunar.json íŒŒì¼ ë¡œë“œ
                if (!response.ok) {
                    throw new Error('JSON íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                const lottoData = await response.json(); // JSON ë°ì´í„° íŒŒì‹±
                calculateFrequency(lottoData); // ì¶œí˜„ ë¹ˆë„ ê³„ì‚°
            } catch (error) {
                console.error('ë¡œë˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
            }
        }

        // ì¶œí˜„ ë¹ˆë„ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
        function calculateFrequency(lottoData) {
            const frequency = {};

            // ê° íšŒì°¨ì˜ ë²ˆí˜¸ë¥¼ ìˆœíšŒí•˜ë©° ë¹ˆë„ ê³„ì‚°
            lottoData.forEach(draw => {
                draw.numbers.forEach(number => {
                    frequency[number] = (frequency[number] || 0) + 1;
                });
                // ë³´ë„ˆìŠ¤ ë²ˆí˜¸ëŠ” ê°€ì¤‘ì¹˜ 0.5ë¡œ ë¹ˆë„ì— í¬í•¨
                if (draw.bonus !== undefined) {
                    frequency[draw.bonus] = (frequency[draw.bonus] || 0) + 0.5;
                }
            });

            // ì¶œí˜„ ë¹ˆë„ì— ë”°ë¼ ë¡œë˜ ë²ˆí˜¸ë¥¼ ê·¸ë£¹í™”
            groupLottoNumbers(frequency);
        }

        // ì¶œí˜„ ë¹ˆë„ì— ë”°ë¼ ë¡œë˜ ë²ˆí˜¸ë¥¼ ê·¸ë£¹í™”í•˜ëŠ” í•¨ìˆ˜
        function groupLottoNumbers(frequency) {
            const lottoByWinCount = {};

            for (const [number, count] of Object.entries(frequency)) {
                if (!lottoByWinCount[count]) {
                    lottoByWinCount[count] = [];
                }
                lottoByWinCount[count].push(Number(number));
            }

            // ê·¸ë£¹í™”ëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¡œë˜ ë²ˆí˜¸ ì„¸íŠ¸ë¥¼ ìƒì„±
            groupAndGenerateLottoSets(lottoByWinCount);
        }

        // ê·¸ë£¹í™”ëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¡œë˜ ë²ˆí˜¸ ì„¸íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
        function groupAndGenerateLottoSets(lottoByWinCount) {
            const groupedLottoByWinCount = { group1: {}, group2: {}, group3: {} };

            // ë‹¹ì²¨ íšŸìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
            const sortedKeys = Object.keys(lottoByWinCount).sort((a, b) => Number(a) - Number(b));
            const groupSize = Math.ceil(sortedKeys.length / 3);

            // ê·¸ë£¹ ë¶„í•  (group1: ìµœì € ë‹¹ì²¨, group2: ì¤‘ê°„ ë‹¹ì²¨, group3: ìµœë‹¤ ë‹¹ì²¨)
            for (let i = 0; i < sortedKeys.length; i++) {
                const key = sortedKeys[i];
                if (i < groupSize) {
                    groupedLottoByWinCount.group1[key] = lottoByWinCount[key];
                } else if (i < groupSize * 2) {
                    groupedLottoByWinCount.group2[key] = lottoByWinCount[key];
                } else {
                    groupedLottoByWinCount.group3[key] = lottoByWinCount[key];
                }
            }

            // ë¡œë˜ ë²ˆí˜¸ ì„¸íŠ¸ ìƒì„± ë° í‘œì‹œ
            displayLottoSets(groupedLottoByWinCount);
        }

        // ë¡œë˜ ë²ˆí˜¸ ì„¸íŠ¸ë¥¼ ìƒì„±í•˜ê³  í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function displayLottoSets(groupedLottoByWinCount) {
            const numbersList = document.getElementById('lottoNumbersList');

            // ë¡œë˜ ë²ˆí˜¸ ì„¸íŠ¸ ìƒì„± í•¨ìˆ˜
            function generateLottoSet() {
                const randomValues = [];

                // ê° ê·¸ë£¹ì—ì„œ ë²ˆí˜¸ë¥¼ ì„ íƒ
                ['group1', 'group2', 'group3'].forEach((group, index) => {
                    const count = index === 0 ? 3 : index === 1 ? 2 : 1; // group1: 3ê°œ, group2: 2ê°œ, group3: 1ê°œ
                    const keys = Object.keys(groupedLottoByWinCount[group]);

                    for (let i = 0; i < count; i++) {
                        if (keys.length === 0) break;

                        const randomIndex = Math.floor(Math.random() * keys.length);
                        const randomKey = keys[randomIndex];
                        const values = groupedLottoByWinCount[group][randomKey];
                        const randomValue = values[Math.floor(Math.random() * values.length)];

                        if (!randomValues.includes(randomValue)) {
                            randomValues.push(randomValue);
                        } else {
                            i--; // ì¤‘ë³µì´ë©´ ë‹¤ì‹œ ì‹œë„
                        }
                    }
                });

                // ë²ˆí˜¸ë¥¼ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
                return randomValues.sort((a, b) => a - b);
            }

            // 5ì„¸íŠ¸ì˜ ë¡œë˜ ë²ˆí˜¸ ìƒì„±
            for (let i = 1; i <= 5; i++) {
                const lottoSet = generateLottoSet();
                const listItem = document.createElement('li');
                listItem.innerHTML = `<strong>${i}ë²ˆ ë¡œë˜ë²ˆí˜¸: <span class="lotto-number">${lottoSet.join(', ')}</span></strong>`;
                numbersList.appendChild(listItem);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ JSON ë°ì´í„° ë¡œë“œ
        window.onload = loadLottoData;
    </script>
</body>
</html>
